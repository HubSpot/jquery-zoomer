<!DOCTYPE html>

<html>
<head>
  <title>jquery.zoomer.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>jquery.zoomer.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="comment">/*
 * jQuery Zoomer v1.1
 *
 * By HubSpot  &gt;('_')&lt;
 *
 * Licensed under the MIT license:
 *   http://www.opensource.org/licenses/mit-license.php
 *
 * Example usage:

$('iframe').zoomer({ width: 200, zoom: 0.5 });

 *
 */</span>

(<span class="keyword">function</span>($){

    <span class="keyword">var</span> methods,
        pluginName = <span class="string">'zoomer'</span>,
        defaults = {
            width: <span class="string">'auto'</span>,
            height: <span class="string">'auto'</span>,
            zoom: <span class="number">0.4</span>,
            tranformOrigin: <span class="string">'0 0'</span>,</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>loading</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            loadingType: <span class="string">'message'</span>, <span class="comment">// other type: 'spinner'</span>
            loadingMessage: <span class="string">'Generating preview...'</span>,
            spinnerURL: <span class="string">'http://oi46.tinypic.com/6y375z.jpg'</span>, <span class="comment">// requires loadingType: 'spinner'</span></pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>hover</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            message: <span class="string">'Open Page'</span>,
            ieMessageButtonClass: <span class="string">'btn btn-secondary'</span>, <span class="comment">// used in IE only</span>
            messageURL: <span class="literal">false</span>,
            onComplete: <span class="keyword">function</span>() {}
        },
        visible = {
            visibility: <span class="string">'visible'</span>
        },
        invisible = {
            visibility: <span class="string">'hidden'</span>
        },
        unselectable = {
            <span class="string">'-webkit-user-select'</span>: <span class="string">'none'</span>,
            <span class="string">'-khtml-user-select'</span>:  <span class="string">'none'</span>,
            <span class="string">'-moz-user-select'</span>:    <span class="string">'none'</span>,
            <span class="string">'-o-user-select'</span>:      <span class="string">'none'</span>,
            <span class="string">'user-select'</span>: <span class="string">'none'</span>,
            <span class="string">'overflow'</span>: <span class="string">'hidden'</span>
        },
        absolute = {
            top: <span class="number">0</span>,
            position: <span class="string">'absolute'</span>
        },
        relative = {
            position: <span class="string">'relative'</span>
        },
        isMSIE = navigator.userAgent.match(<span class="regexp">/MSIE/</span>),
        MSIEVersion = navigator.userAgent.match(<span class="regexp">/MSIE (\d\.\d+)/</span>) ? parseInt(RegExp.$<span class="number">1</span>, <span class="number">10</span>) : <span class="literal">null</span>
    ;

    methods = {

        init: <span class="keyword">function</span>(opts) {
            <span class="keyword">return</span> <span class="keyword">this</span>.each(<span class="keyword">function</span>(){
                <span class="keyword">var</span> $el = $(<span class="keyword">this</span>),
                    options = $.extend({}, defaults, opts)
                ;

                options.src = $el.attr(<span class="string">'src'</span>);

                $el.data(pluginName, options);

                $el[pluginName](<span class="string">'zoomer'</span>);
            });
        },

        zoomer: <span class="keyword">function</span>() {
            <span class="keyword">var</span> $el = $(<span class="keyword">this</span>), options = $el.data(pluginName);

            $el
                .css(invisible)
                .css(unselectable)
            ;

            <span class="keyword">if</span> (options.zoom === <span class="string">'auto'</span>) {
                <span class="keyword">if</span> (options.width === <span class="string">'auto'</span> &amp;&amp; options.height === <span class="string">'auto'</span>) {
                    $.error(<span class="string">'jQuery.zoomer: You must set either zoom or height and width.'</span>);
                    <span class="keyword">return</span>;
                }
                options.zoom = options.width / $(window).width();
            }

            <span class="keyword">if</span> (options.width === <span class="string">'auto'</span>) {
                options.width = $(window).height() * options.zoom;
            }

            <span class="keyword">if</span> (options.height === <span class="string">'auto'</span>) {
                options.height = $(window).height() * options.zoom;
            }

            <span class="keyword">if</span> (options.loadingType === <span class="string">'spinner'</span>) {
                options.loadingMessage = <span class="string">'&lt;img style="padding: '</span> + parseInt((options.height - <span class="number">17</span>) / <span class="number">2</span>, <span class="number">10</span>) + <span class="string">'px 0" src="'</span> + options.spinnerURL + <span class="string">'" /&gt;'</span>;
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>fix bug in older version of chrome:
<a href="http://stackoverflow.com/questions/5159713/">http://stackoverflow.com/questions/5159713/</a></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="keyword">if</span> (navigator.userAgent.indexOf(<span class="string">'Chrome/10.0.648'</span>) &gt; -<span class="number">1</span>) {
                options.zoom = Math.sqrt(<span class="number">1</span> / options.zoom);
            }

            options.externalSrc = <span class="literal">true</span>;

            <span class="keyword">try</span> {
                <span class="keyword">if</span> ($el.get(<span class="number">0</span>).contentWindow.document) {
                    options.externalSrc = <span class="literal">false</span>;
                }
            } <span class="keyword">catch</span> (e) {}

            $el[pluginName](<span class="string">'setUpWrapper'</span>);

            $el[pluginName](<span class="string">'zoom'</span>);

            <span class="keyword">return</span> $el;
        },

        setUpWrapper: <span class="keyword">function</span>() {
            <span class="keyword">var</span> $el = $(<span class="keyword">this</span>), options = $el.data(pluginName);

            <span class="keyword">if</span> (!$el.parents(<span class="string">'.zoomer-wrapper'</span>).length) {
                $el
                    .wrap(
                        $(<span class="string">'&lt;div/&gt;'</span>)
                            .addClass(<span class="string">'zoomer-wrapper'</span>)
                            .css(unselectable)
                            .css(relative)
                    )
                    .wrap(
                        $(<span class="string">'&lt;div/&gt;'</span>)
                            .addClass(<span class="string">'zoomer-small'</span>)
                            .css(invisible)
                            .css(unselectable)
                    )
                ;
            }

            options.zoomerWrapper = $el.parents(<span class="string">'.zoomer-wrapper'</span>);

            options.zoomerSmall = $el.parents(<span class="string">'.zoomer-small'</span>);

            options.zoomerCover = $(<span class="string">'&lt;div/&gt;'</span>)
                .addClass(<span class="string">'zoomer-cover'</span>)
                .css(unselectable)
                .css(absolute)
                .css({
                    textAlign: <span class="string">'center'</span>,
                    fontSize: <span class="string">'15px'</span>
                })
            ;

            options.zoomerLink = $(<span class="string">'&lt;a/&gt;'</span>)
                .attr(<span class="string">'target'</span>, <span class="string">'_blank'</span>)
                .html(options.message)
                .css({
                    height: options.height,
                    width: options.width,
                    color: <span class="string">'#444'</span>,
                    display: <span class="string">'block'</span>,
                    lineHeight: (parseInt(options.height, <span class="number">10</span>) - parseInt((options.height - <span class="number">80</span>) / <span class="number">10</span>, <span class="number">10</span>)) + <span class="string">'px'</span>,
                    textDecoration: <span class="string">'none'</span>
                })
                .css(<span class="string">'background'</span>, <span class="string">'-moz-radial-gradient(center center, circle farthest-corner, rgba(255, 255, 255, 0.95) 0%, rgba(255, 255, 255, 0.4) 100%) repeat scroll 0 0 transparent'</span>)
                .css(<span class="string">'background-image'</span>, <span class="string">'-webkit-gradient(radial, center center, 0, center center, '</span> + parseInt(options.width, <span class="number">10</span>) + <span class="string">', from(rgba(255, 255, 255, 0.95)), to(rgba(255, 255, 255, 0.4)))'</span>)
                .mousedown(<span class="keyword">function</span>(){
                    $(<span class="keyword">this</span>).css(<span class="string">'box-shadow'</span>, <span class="string">'inset 0px 2px 8px rgba(100, 100, 100, 0.4)'</span>);
                })
                .bind(<span class="string">'mouseout mouseup'</span>, <span class="keyword">function</span>(){
                    $(<span class="keyword">this</span>).css(<span class="string">'box-shadow'</span>, <span class="string">'none'</span>);
                })
                .hide()
            ;

            <span class="keyword">if</span> (isMSIE) {
                options.zoomerLink.css({
                    backgroundColor: <span class="string">'rgba(255, 255, 255, 0.5)'</span>
                });
            }

            <span class="keyword">if</span> (options.click) {
                options.zoomerLink
                    .attr(<span class="string">'href'</span>, options.messageURL || options.src || <span class="string">'#'</span>)
                    .unbind(<span class="string">'click'</span>).bind(<span class="string">'click'</span>, options.click)
                ;
            } <span class="keyword">else</span> {
                options.zoomerLink.attr(<span class="string">'href'</span>, options.messageURL || options.src);
            }

            options.zoomerCover
                .append(options.zoomerLink)
                .hover(<span class="keyword">function</span>(){
                    options.zoomerLink.show();
                    $(<span class="keyword">this</span>).css(<span class="string">'box-shadow'</span>, <span class="string">'inset 2px 2px '</span> + (parseInt(options.width, <span class="number">10</span>) * <span class="number">2</span>) + <span class="string">'px rgba(255, 255, 255, 0.2)'</span>);
                }, <span class="keyword">function</span>(){
                    options.zoomerLink.hide();
                    $(<span class="keyword">this</span>).css(<span class="string">'box-shadow'</span>, <span class="string">'none'</span>);
                })
                .mousedown(<span class="keyword">function</span>(){
                    $(<span class="keyword">this</span>).css(<span class="string">'box-shadow'</span>, <span class="string">'inset 2px 2px '</span> + (parseInt(options.width, <span class="number">10</span>) * <span class="number">2</span>) + <span class="string">'px rgba(200, 200, 200, 0.8)'</span>);
                })
                .bind(<span class="string">'mouseout mouseup'</span>, <span class="keyword">function</span>(){
                    $(<span class="keyword">this</span>).css(<span class="string">'box-shadow'</span>, <span class="string">'none'</span>);
                })
            ;

            options.zoomerLoader = $(<span class="string">'&lt;div/&gt;'</span>)
                .addClass(<span class="string">'zoomer-loader'</span>)
                .css(invisible)
                .css(unselectable)
                .css(absolute)
                .css({
                    textAlign: <span class="string">'center'</span>,
                    fontSize: <span class="string">'15px'</span>,
                    lineHeight: (parseInt(options.height, <span class="number">10</span>) - parseInt((options.height - <span class="number">80</span>) / <span class="number">10</span>, <span class="number">10</span>)) + <span class="string">'px'</span>,
                    background: <span class="string">'#fff'</span>
                })
                .html(options.loadingMessage)
            ;

            options.zoomerWrapper
                .append(options.zoomerCover)
                .append(options.zoomerLoader)
            ;

            <span class="keyword">if</span> (isMSIE) { options.zoomerLoader.css(invisible); }

            <span class="keyword">return</span> $el[pluginName](<span class="string">'updateWrapper'</span>)[pluginName](<span class="string">'fadeOut'</span>);
        },

        updateWrapper: <span class="keyword">function</span>() {
            <span class="keyword">var</span> $el = $(<span class="keyword">this</span>), options = $el.data(pluginName);

            $.each([options.zoomerWrapper.get(<span class="number">0</span>), options.zoomerCover.get(<span class="number">0</span>), options.zoomerLoader.get(<span class="number">0</span>), options.zoomerSmall.get(<span class="number">0</span>)], <span class="keyword">function</span>(){
                $(<span class="keyword">this</span>).css({
                    height: options.height,
                    width: options.width
                });
            });

            <span class="keyword">return</span> $el;
        },

        fadeIn: <span class="keyword">function</span>() {
            <span class="keyword">var</span> $el = $(<span class="keyword">this</span>), options = $el.data(pluginName);

            <span class="keyword">if</span> (isMSIE) { <span class="keyword">return</span> $el; }

            $el.css(invisible);

            options.zoomerSmall
                .stop()
                .css(<span class="string">'opacity'</span>, <span class="number">0</span>)
                .css(visible)
                .animate({ <span class="string">'opacity'</span>: <span class="number">1</span> }, <span class="number">150</span>, <span class="keyword">function</span>(){
                    $el
                        .css(visible)
                        .css(<span class="string">'opacity'</span>, <span class="number">0</span>)
                        .animate({ <span class="string">'opacity'</span>: <span class="number">1</span> }, <span class="number">500</span>)
                    ;
                })
            ;

            options.zoomerLoader
                .show()
                .animate({ <span class="string">'opacity'</span>: <span class="number">0</span> }, <span class="number">300</span>, <span class="keyword">function</span>(){
                    $(<span class="keyword">this</span>).hide();
                })
            ;

            <span class="keyword">return</span> $el;
        },

        fadeOut: <span class="keyword">function</span>() {
            <span class="keyword">var</span> $el = $(<span class="keyword">this</span>), options = $el.data(pluginName);

            <span class="keyword">if</span> (isMSIE) { <span class="keyword">return</span> $el; }

            options.zoomerSmall
                .stop()
                .animate({ <span class="string">'opacity'</span>: <span class="number">0</span> }, <span class="number">300</span>, <span class="keyword">function</span>(){
                    $(<span class="keyword">this</span>).css(<span class="string">'visibility'</span>, <span class="string">'hidden'</span>);
                })
            ;

            options.zoomerLoader
                .css(<span class="string">'opacity'</span>, <span class="number">0</span>)
                .css(visible)
                .show()
                .animate({ opacity: <span class="number">1</span> }, <span class="number">100</span>)
            ;

            <span class="keyword">return</span> $el;
        },

        zoom: <span class="keyword">function</span>() {
            <span class="keyword">var</span> $el = $(<span class="keyword">this</span>), options = $el.data(pluginName);

            <span class="keyword">if</span> (isMSIE) {
                setTimeout(<span class="keyword">function</span>(){
                    $el
                        .css({
                            zoom: options.zoom,
                            height: parseInt((options.height / options.zoom) *  (<span class="number">1</span> / (MSIEVersion &gt;= <span class="number">9</span> ? <span class="number">1</span> : options.zoom)), <span class="number">10</span>),
                            width: parseInt((options.width / options.zoom) * (<span class="number">1</span> / (MSIEVersion &gt;= <span class="number">9</span> ? <span class="number">1</span> : options.zoom)), <span class="number">10</span>)
                        })
                        .css(visible)
                    ;

                    options.zoomerLink.remove();

                    options.zoomerCover
                        .unbind(<span class="string">'hover mouseover mouseout'</span>)
                        .addClass(options.ieMessageButtonClass)
                        .html(options.message)
                        .css({
                            width: <span class="number">94</span>,
                            height: <span class="number">14</span>,
                            fontSize: <span class="number">12</span>,
                            padding: <span class="string">'6px 18px 6px 18px'</span>,
                            top: parseInt(options.height - (<span class="number">12</span> + (<span class="number">2</span> * <span class="number">6</span>) + <span class="number">2</span> + <span class="number">10</span>), <span class="number">10</span>),
                            left: parseInt((options.width - (<span class="number">94</span> + (<span class="number">2</span> * <span class="number">18</span>))) / <span class="number">2</span>, <span class="number">10</span>)
                        })
                        .show()
                    ;

                    <span class="keyword">if</span> (!options.click) {
                        options.click = <span class="keyword">function</span>() {
                            location.href = options.messageURL || options.src;
                        };
                    }

                    options.zoomerCover.unbind(<span class="string">'click'</span>).bind(<span class="string">'click'</span>, options.click);

                    options.onComplete($el);
                }, <span class="number">1000</span>);

                <span class="keyword">return</span> $el;
            }

            <span class="keyword">if</span> (options.externalSrc) {
                $el
                    .css({
                        height: options.height / options.zoom,
                        width: options.width / options.zoom,
                                <span class="string">'transform-origin'</span>: options.tranformOrigin,
                        <span class="string">'-webkit-transform-origin'</span>: options.tranformOrigin,
                           <span class="string">'-moz-transform-origin'</span>: options.tranformOrigin,
                             <span class="string">'-o-transform-origin'</span>: options.tranformOrigin,
                                <span class="string">'transform'</span>: <span class="string">'scale('</span> + options.zoom + <span class="string">')'</span>,
                        <span class="string">'-webkit-transform'</span>: <span class="string">'scale('</span> + options.zoom + <span class="string">')'</span>,
                           <span class="string">'-moz-transform'</span>: <span class="string">'scale('</span> + options.zoom + <span class="string">')'</span>,
                             <span class="string">'-o-transform'</span>: <span class="string">'scale('</span> + options.zoom + <span class="string">')'</span>
                    })
                    .css(visible)
                ;

                $el[pluginName](<span class="string">'fadeIn'</span>);

                options.onComplete($el);

                <span class="keyword">return</span> $el;
            }

            $el
                .css({
                    height: options.height / options.zoom,
                    width: options.width / options.zoom
                })
                .load(<span class="keyword">function</span>(){
                    $el.contents().find(<span class="string">'html'</span>).css({
                                <span class="string">'transform-origin'</span>: options.tranformOrigin,
                        <span class="string">'-webkit-transform-origin'</span>: options.tranformOrigin,
                           <span class="string">'-moz-transform-origin'</span>: options.tranformOrigin,
                             <span class="string">'-o-transform-origin'</span>: options.tranformOrigin,
                                <span class="string">'transform'</span>: <span class="string">'scale('</span> + options.zoom + <span class="string">')'</span>,
                        <span class="string">'-webkit-transform'</span>: <span class="string">'scale('</span> + options.zoom + <span class="string">')'</span>,
                           <span class="string">'-moz-transform'</span>: <span class="string">'scale('</span> + options.zoom + <span class="string">')'</span>,
                             <span class="string">'-o-transform'</span>: <span class="string">'scale('</span> + options.zoom + <span class="string">')'</span>
                    });

                    $el[pluginName](<span class="string">'fadeIn'</span>);

                    options.onComplete($el);
                })
            ;

            <span class="keyword">return</span> $el;
        },

        src: <span class="keyword">function</span>(src) {
            <span class="keyword">var</span> $el = $(<span class="keyword">this</span>),
                options = $el.data(pluginName)
            ;

            options.src = src;

            $el[pluginName](<span class="string">'fadeOut'</span>).attr(<span class="string">'src'</span>, src);

            <span class="keyword">return</span> $el;
        },

        refresh: <span class="keyword">function</span>() {
            <span class="keyword">var</span> $el = $(<span class="keyword">this</span>), options = $el.data(pluginName);

            <span class="keyword">return</span> $el[pluginName](<span class="string">'src'</span>, options.src);
        },

        zoomedBodyHeight: <span class="keyword">function</span>() {
            <span class="keyword">var</span> $el = $(<span class="keyword">this</span>), options = $el.data(pluginName);

            <span class="keyword">if</span> (options.externalSrc) {
                <span class="keyword">return</span> $.error(<span class="string">'jQuery.zoomer: cannot access bodyHeight of an external iFrame'</span>);
            }

            <span class="keyword">return</span> options.zoom * $($el.get(<span class="number">0</span>).contentWindow.document).height();
        }
    };

    $.fn[pluginName] = <span class="keyword">function</span>(options) {
        <span class="keyword">if</span> (methods[options]) {
            <span class="keyword">return</span> methods[options].apply(<span class="keyword">this</span>, Array.prototype.slice.call(arguments, <span class="number">1</span>));
        } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> options === <span class="string">'object'</span> || ! options) {
            <span class="keyword">return</span> methods.init.apply(<span class="keyword">this</span>, arguments);
        } <span class="keyword">else</span> {
            $.error(<span class="string">'jQuery.'</span> + pluginName + <span class="string">': Method '</span> +  options + <span class="string">' does not exist'</span>);
        }
    };

})(jQuery);</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
